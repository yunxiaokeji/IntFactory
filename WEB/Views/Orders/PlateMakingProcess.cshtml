@{
    var order = (IntFactoryEntity.OrderEntity)ViewBag.Model;
    var goods = (List<IntFactoryEntity.GoodsDoc>)ViewBag.List;
    var obj = (List<IntFactoryEntity.Task.PlateMaking>)ViewBag.Obj;
    ViewBag.title = "制版工艺单";
    Layout = null;
}

<!DOCTYPE html>

<html>
<head>
    <meta charset="UTF-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta http-equiv="content-language" content="zh-CN" />
	<meta name="author" content="zuroke" />
    <title>@ViewBag.title</title>
    <link href="/modules/css/default/layout.css" rel="stylesheet" />
    <link href="/modules/css/base.css" rel="stylesheet" />
    <link href="/modules/css/order/platemakingprocess.css" rel="stylesheet" />
    <link href="/modules/css/iconfont/iconfont.css" rel="stylesheet" />

    <script src="/Scripts/jquery-1.11.1.js"></script>    
    <script src="/Scripts/sea.js"></script>
    <script src="/Scripts/sea-config.js"></script>
    <script type="text/javascript">
        seajs.use(["scripts/orders/platemakingprocess"], function (obj) {
            obj.init('@(order.Platemaking)');
        })
    </script>
</head>
<body>
    <div class="report">
        <div class="preview">预览:</div>    
        <div class="process left">
            <table style="width:955px;">
                <tr class="bgcolorC0C0C0" style="height:50px">
                    <td class="no-border-right">
                        <img src="@(order.OrderImage==""?"/modules/images/none-img.png":order.OrderImage)" />
                    </td>
                    <td class="no-border-left" colspan="5">
                        <div class="titlename">
                            生产工艺单
                            <span class="red">（此单所示左右指穿起计）</span>
                        </div>
                    </td>                
                </tr>
                <tr>
                    <td>跨界款号：</td>
                    <td>@(order.IntGoodsCode==""?"未设置":order.IntGoodsCode)</td>
                    <td>采购负责人：</td>
                    <td>卢云</td>
                    <td>下单日期：</td>
                    <td>@(order.CreateTime.ToString("yyyy-MM-dd"))</td>
                </tr>
                <tr>
                    <td>销售负责人：</td>
                    <td>清扬</td>
                    <td>纸样师负责人：</td>
                    <td>萧秋水</td>
                    <td>合同货期：</td>
                    <td>@(order.PlanTime.ToString("yyyy-MM-dd") == "0001-01-01" ? "未设置" : order.PlanTime.ToString("yyyy-MM-dd"))</td>
                </tr>
                <tr>
                    <td>理单负责人：</td>
                    <td>卫青</td>
                    <td>QC负责人：</td>
                    <td>李世明</td>
                    <td class="no-border-right">准确资料签章：</td>       
                    <td class="no-border-left"></td>         
                </tr>
            </table>   
            <table class="navgoods no-border">
                <tr>
                    <td colspan="7" class="font18 no-border-top fontbold bgcolorC0C0C0" style="height:40px;">下单明细</td>
                    <td class="no-border-top" style="width:161px">前片图片</td>
                    <td class="no-border-top" style="width:161px">后片图片</td>
                </tr>
                <tr>
                    <td class="bgcolorC0C0C0 fontbold">规格</td>
                    <td class="bgcolorC0C0C0 fontbold">下单数量</td>
                    <td class="bgcolorC0C0C0 fontbold">裁片/织片数量</td>
                    <td class="bgcolorC0C0C0 fontbold">缝制/套口数量</td>
                    <td class="bgcolorC0C0C0 fontbold">发货数量</td>
                    <td class="bgcolorC0C0C0 fontbold">剩余未发</td>                
                    <td class="bgcolorC0C0C0 fontbold">小计</td>
                    <td rowspan="9"><img src="/modules/images/none-img.png" /></td>
                    <td rowspan="9"><img src="/modules/images/none-img.png" /></td>
                </tr>
                @if (order.OrderGoods.Count > 0)
                {
                    foreach (var detail in order.OrderGoods)
                    { 
                    <tr class="item cart-item" >
                        <td>@(detail.Remark)</td>
                        <td class="center good1">@(detail.Quantity)</td>
                        <td class="center good2">@(detail.CutQuantity)</td>
                        <td class="center good3">@(detail.Complete)</td>
                        <td class="center good4">@(detail.SendQuantity)</td>
                        <td class="center good5">@(detail.Complete - detail.SendQuantity)</td>                    
                        <td class="tRight good6">@((detail.TotalMoney).ToString("f2"))</td>
                    </tr>                
                    }
                    <tr class="total-items bold" >
                        <td class="">合计：</td>
                        <td class="center" data-class="good1"></td>
                        <td class="center" data-class="good2"></td>
                        <td class="center" data-class="good3"></td>
                        <td class="center" data-class="good4"></td>
                        <td class="center" data-class="good5"></td>                    
                        <td class="tRight" data-class="good6"></td>
                    </tr>
                }
                else
                {
                    <tr><td colspan="7"><div class="nodata-txt">暂无明细</div></td></tr>
                }   
                    
                <tr>
                    <td colspan="7">
                        <table class="no-border" id="navsenddoc">
                            <tr>
                                <td colspan="4" class="font18 bgcolorC0C0C0 fontbold no-border" style="height:40px;">裁片/织片</td>
                            </tr>
                            <tr class="bgcolorC0C0C0 fontbold">
                                <td class="no-border-left no-border-fight">单号</td>
                                <td>数量</td>
                                <td>登记人</td>
                                <td class="width no-border-right">登记时间</td>               
                            </tr>
                            @if (goods.Count>0)
	                        {
		                        foreach (var item in goods)
	                            {
		                            <tr>
                                        <td class="no-border-left no-border-fight">@(item.DocCode)</td>
                                        <td class="cut1">@(item.Quantity)</td>
                                        <td>@(item.CreateUser.Name==""?"--": item.CreateUser.Name)</td>
                                        <td class="no-border-right">@(item.CreateTime.ToString("yyyy-MM-dd hh:mm:ss"))</td> 
                                    </tr>
	                            }
                                <tr class="total-item bold">
                                    <td class="no-border-left no-border-fight no-border-bottom">合计：</td>
                                    <td class="center no-border-bottom" data-class="cut1"></td>
                                    <td class='center no-border-bottom no-border-right'></td>
                                    <td class='center no-border-bottom no-border-right no-border-left'></td>                                
                                </tr>
                            }
                            else
                            {
                                <tr><td colspan="7"><div class="nodata-txt no-border-left no-border-bottom no-border-right">暂无数据</div></td></tr>
	                        }
                        </table>
                    </td>
                
                </tr>     
            </table>
            <table class="navproducts no-border">
                <tr>
                    <td colspan="11" class="font18 fontbold no-border-top tLeft bgcolorC0C0C0 hight40">一、材料成本</td>
                </tr>
                <tr class="bgcolorC0C0C0 fontbold" style="height:30px;">
                    <td class="width100">样图</td>
                    <td class="width60">材料名称</td>
                    <td class="width100">编码</td>
                    <td class="width100">规格</td>
                    <td class="width50">单位</td>
                    <td class="width50">单价</td>
                    <td class="width100">消耗量</td>
                    <td class="width100">损耗量</td>
                    <td class="width100">损耗率</td>
                    <td class="width100">采购量</td>
                    <td class="width100">小计</td>
                </tr>
                @if (order.Details.Count>0)
                {
                    foreach (var detail in order.Details)
                    {
                        <tr class="products">
                            <td class="width100">
                                <img onerror="$(this).attr('src','/modules/images/img-noimg.png')" src="@(string.IsNullOrEmpty(detail.ImgS) ? detail.ProductImage : detail.ImgS)" />
                            </td>
                            <td class="width60">@(detail.ProductName)</td>
                            <td class="width100">@(string.IsNullOrEmpty(detail.DetailsCode) ? detail.ProductCode : detail.DetailsCode)</td>
                            <td class="width100">@(detail.Remark)</td>
                            <td class="width50">@(detail.UnitName)</td>
                            <td class="width50">@(detail.Price.ToString("f2"))</td>
                            <td class="width100">@((detail.Quantity * order.PlanQuantity).ToString("f3"))</td>
                            <td class="width100">@((detail.Loss * order.PlanQuantity).ToString("f3"))</td>
                            <td class="width100">@(detail.LossRate.ToString("f3"))</td>
                            <td class="width100">@(((detail.Quantity * order.PlanQuantity)+(detail.Loss * order.PlanQuantity)).ToString("f3"))</td>
                            <td class="width100 moneytotal">@((detail.TotalMoney * order.PlanQuantity).ToString("f3"))</td>
                        </tr>
                    }
                    <tr class="total-items bold">
                        <td colspan="9"></td>
                        <td class="tRight">成本合计：</td>
                        <td class="tRight" data-class="moneytotal"></td>
                    </tr>
                }
                else
                {
                    <tr><td colspan="11"><div class="nodata-txt">暂无材料</div></td></tr>
                }           
            </table>                      
            <table class="navengraving no-border" style="width:955px;">
                <tr>
                    <td colspan="10" class="font18 fontbold no-border-top tLeft bgcolorC0C0C0 hight40">二、制版</td>
                </tr>
                <tr>
                    <td id="Platemak" colspan="10"></td>
                </tr>

                <tr>
                    <td class="bgcolorC0C0C0 fontbold font18 tLeft hight40" colspan="10">三、工艺</td>
                </tr>
                <tr>
                    <td colspan="2">图标</td>
                    <td colspan="2">名称</td>
                    <td colspan="4">描述</td>
                    <td colspan="2">创建时间</td>
                </tr>
                @if (obj.Count>0)
                {
                    foreach (var item in obj)
                    {
                        <tr>
                            <td colspan="2"><img style="width:30px;height:30px;" src="@(item.Icon)" /></td>
                            <td colspan="2">@(item.Title)</td>
                            <td colspan="4">@(item.Remark)</td>
                            <td colspan="2">@(item.CreateTime.ToString("yyyy-MM-dd hh:mm:ss"))</td>
                        </tr>
                    }
                }
                else
                {
                    <tr>
                        <td colspan="10"><div class="nodata-txt">暂无工艺</div></td>
                    </tr>
                }


            
                <tr>
                    <td class="width115 font16 fontbold tLeft" colspan="10">备注：避免每个人对专业术语理解误差，由此工艺单供参考，具体工艺参照样衣</td>                
                </tr>
                <tr>
                    <td class="width115 font16 fontbold tLeft" colspan="10">*****注：请跟单QC、裁床、缝制、后整、负责人仔细阅读此工艺单并理解，如有疑问及时与技术部相关人员联系！（工艺单看了，未理解，等同没有看）</td>                
                </tr>
            </table>       
            <div class="font18">
                <span class="fontbold">制表人:</span>
                <span>萧秋水</span>
                <span class="fontbold">审核人:</span>
                <span>卫青</span>
                <span class="fontbold">制单日期:</span>
                <span>2015.4.21</span>
            </div>
            <div>
                <span class="btn mTop10">保存</span>
            </div>
        </div>
        <div class="print hide mTop25">
            
        </div>
    </div>
</body>
</html>
